<html>
<head>
<meta charset="utf-8">

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5W8DZRW');</script>
<!-- End Google Tag Manager -->

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<link rel="Shortcut Icon" href="/assets/images/favicon.ico" type="image/x-icon"/>
<link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png"/>
<link rel="apple-touch-icon" sizes="72x72"
      href="/assets/images/apple-touch-icon-72x72.png"/>
<link rel="apple-touch-icon" sizes="114x114"
      href="/assets/images/apple-touch-icon-114x114.png"/>
<link rel="apple-touch-icon" sizes="144x144"
      href="/assets/images/apple-touch-icon-144x144.png"/>
<link rel="stylesheet" href="/_assets/styles.css">


<!-- Social Media tag Starts -->
<!-- Place this data between the <head> tags of your website -->
<!-- Open Graph data -->
<meta property="og:title" content=""/>
<meta property="og:type" content="website"/>
<meta property="og:url" content="https://www.kotlincn.net/docs/tutorials/native/mpp-ios-android.html"/>
<meta property="og:image" content="https://www.kotlincn.net/assets/images/open-graph/kotlin_250x250.png"/>
    <meta property="og:description" content="在 iOS 与 Android 之间共享 Kotlin 代码">
<meta property="og:site_name" content="Kotlin"/>

<!-- Twitter Card data -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@kotlin">
<meta name="twitter:title" content="">
    <meta name="twitter:description" content="在 iOS 与 Android 之间共享 Kotlin 代码">
<meta name="twitter:image:src" content="https://www.kotlincn.net/assets/images/twitter-card/kotlin_800x320.png">
<!-- Social Media tag Ends -->

    <title>多平台项目: iOS 与 Android - Kotlin 语言中文站</title>

    <script src="/_assets/common.js"></script>
    <link rel="stylesheet" href="/_assets/common.css"/>
</head>
<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5W8DZRW"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<div class="global-layout">

<header class="global-header">
    <div class="global-header-panel">
        <div class="g-layout">
            <a class="global-header-logo" href="/">Kotlin</a>
<nav class="global-nav">
    <div class="nav-links">
            <a href="https://www.kotliner.cn/" class="nav-item">
                博客
            </a>
            <a href="https://discuss.kotliner.cn/" class="nav-item">
                论坛
            </a>
            <a href="/docs/reference/" class="nav-item">
                学习
            </a>
            <a href="/community/" class="nav-item">
                社区
            </a>
            <a href="https://play.kotlinlang.org" class="nav-item">
                在线试用
            </a>
    </div>

    <div class="search-button">
        <div class="icon"></div>
    </div>
</nav>        </div>
    </div>


    <div class="g-layout">
    </div>
</header>
    <div class="g-layout global-content">
        <nav class="docs-nav">
                <div class="nav-item-wrap">
                        <a href="/docs/reference/" class="nav-item">
                            <span class="nav-item-text">
                                参考
                            </span>
                        </a>
                </div>
                <div class="nav-item-wrap">
                        <a href="/docs/tutorials/" class="nav-item is_active">
                            <span class="nav-item-text">
                                教程
                            </span>
                        </a>
                </div>
                <div class="nav-item-wrap">
                        <a href="/docs/books.html" class="nav-item">
                            <span class="nav-item-text">
                                图书
                            </span>
                        </a>
                </div>
                <div class="nav-item-wrap">
                        <a href="/docs/resources.html" class="nav-item">
                            <span class="nav-item-text">
                                更多资源
                            </span>
                        </a>
                </div>
        </nav>

    <div class="g-grid">
        <aside class="g-3">
            <div class="js-side-tree-nav">
                    <nav class="side-tree-nav">
                <div class="tree-item tree-branch js-item js-branch _opened"
         data-id="开始">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title is_active">
            <div class="marker"></div>
            <div class="text">开始</div>
        </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/getting-started.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">以 IntelliJ IDEA 入门</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/getting-started-eclipse.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">以 Eclipse 入门</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/command-line.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">使用命令行编译器</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/quick-run.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">运行代码片段</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/build-tools.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">使用构建工具</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/koans.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">心印</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/competitive-programming.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">竞技程序设计</span>
            </a>
    </div>

    </div>

                <div class="tree-item tree-branch js-item js-branch _opened"
         data-id="Android">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title is_active">
            <div class="marker"></div>
            <div class="text">Android</div>
        </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-android.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">Android 开发入门</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/android-plugin.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">Kotlin Android 扩展</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/android-frameworks.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">Android 框架</span>
            </a>
    </div>

    </div>

                <div class="tree-item tree-branch js-item js-branch _opened"
         data-id="Java 互操作">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title is_active">
            <div class="marker"></div>
            <div class="text">Java 互操作</div>
        </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/mixing-java-kotlin-intellij.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">在一个项目中混用 Java 与 Kotlin</span>
            </a>
    </div>

    </div>

                <div class="tree-item tree-branch js-item js-branch _opened"
         data-id="JavaScript">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title is_active">
            <div class="marker"></div>
            <div class="text">JavaScript</div>
        </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/javascript/kotlin-to-javascript/kotlin-to-javascript.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">Kotlin 转 JavaScript</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/javascript/getting-started-gradle/getting-started-with-gradle.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">以 Gradle 入门</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/javascript/getting-started-idea/getting-started-with-intellij-idea.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">以 IntelliJ IDEA 入门</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/javascript/getting-started-maven/getting-started-with-maven.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">以 Maven 入门</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/javascript/getting-started-command-line/command-line-library-js.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">使用命令行编译器创建 Kotlin JavaScript 库</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/javascript/working-with-modules/working-with-modules.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">Kotlin 与 JavaScript 模块合用</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/javascript/working-with-javascript.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">与 JavaScript 合用</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/javascript/debugging-javascript/debugging-javascript.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">在浏览器中调试 Kotlin</span>
            </a>
    </div>

    </div>

                <div class="tree-item tree-branch js-item js-branch _opened"
         data-id="多平台项目">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title is_active">
            <div class="marker"></div>
            <div class="text">多平台项目</div>
        </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <div class="tree-item-title tree-leaf-title js-item-title js-leaf-title is_active ">
                <div class="marker"></div>
                <div class="text">iOS 与 Android</div>
            </div>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/multiplatform-library.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">多平台库</span>
            </a>
    </div>

    </div>

                <div class="tree-item tree-branch js-item js-branch _opened"
         data-id="原生">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title is_active">
            <div class="marker"></div>
            <div class="text">原生</div>
        </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/native/basic-kotlin-native-app.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">基本 Kotlin/Native 应用程序</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/native/mapping-primitive-data-types-from-c.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">映射来自 C 语言的原始数据类型</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/native/mapping-struct-union-types-from-c.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">映射来自 C 语言的结构与联合类型</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/native/mapping-function-pointers-from-c.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">映射来自 C 语言的函数指针</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/native/mapping-strings-from-c.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">映射来自 C 语言的字符串</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/native/dynamic-libraries.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">Kotlin/Native 开发动态库</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/native/apple-framework.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">Kotlin/Native 开发 Apple Framework</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/multiplatform-library.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">发布 Kotlin/Native 库</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/native/curl.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">在应用中使用 C 语言互操作与 libcurl</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <div class="tree-item-title tree-leaf-title js-item-title js-leaf-title is_active ">
                <div class="marker"></div>
                <div class="text">构建 iOS 与 Android 应用</div>
            </div>
    </div>

    </div>

                <div class="tree-item tree-branch js-item js-branch _opened"
         data-id="协程">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title is_active">
            <div class="marker"></div>
            <div class="text">协程</div>
        </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/coroutines/async-programming.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">异步程序设计</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/coroutines/coroutines-basic-jvm.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">JVM 平台的 Kotlin 协程简介</span>
            </a>
    </div>

    </div>

                <div class="tree-item tree-branch js-item js-branch _opened"
         data-id="Web 开发">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title is_active">
            <div class="marker"></div>
            <div class="text">Web 开发</div>
        </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/httpservlets.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">用 Http Servlets 创建 web 应用</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/spring-boot-restful.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">用  Spring Boot 创建 RESTful Web 服务</span>
            </a>
    </div>

    </div>

                <div class="tree-item tree-branch js-item js-branch _opened"
         data-id="工具">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title is_active">
            <div class="marker"></div>
            <div class="text">工具</div>
        </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-and-ci.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">TeamCity 配置 Kotlin</span>
            </a>
    </div>

    </div>

                <div class="tree-item tree-branch js-item js-branch _opened"
         data-id="教学">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title is_active">
            <div class="marker"></div>
            <div class="text">教学</div>
        </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/edu-tools-learner.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">通过 EduTools 插件学习 Kotlin</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/edu-tools-educator.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">通过 EduTools 插件讲授 Kotlin</span>
            </a>
    </div>

    </div>

                <div class="tree-item tree-branch js-item js-branch _opened"
         data-id="迁移自 Python">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title is_active">
            <div class="marker"></div>
            <div class="text">迁移自 Python</div>
        </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/introduction.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">简介</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/hello-world.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">Hello World</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/compiling-and-running.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">编译与运行</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/declaring-variables.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">声明变量</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/primitive-data-types-and-their-limitations.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">原生数据类型及其表示范围</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/strings.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">字符串</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/conditionals.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">条件式</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/collections.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">集合</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/loops.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">循环</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/functions.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">函数</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/classes.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">类</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/exceptions.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">异常</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/null-safety.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">空安全</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/functional-programming.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">函数式编程</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/packages-and-imports.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">包与导入</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/visibility-modifiers.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">可见性修饰符</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/inheritance.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">继承</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/objects-and-companion-objects.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">对象与伴生对象</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/generics.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">泛型</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/extension-functionsproperties.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">扩展函数/属性</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/member-references-and-reflection.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">成员引用与反射</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/annotations.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">注解</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/file-io.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">文件 I/O</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/scoped-resource-usage.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">作用域内资源用法</span>
            </a>
    </div>

                    <div class="tree-item tree-leaf js-item js-leaf ">
            <a href="/docs/tutorials/kotlin-for-py/documentation.html"
               class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
            >
                <span class="marker"></span>
                <span class="text">编写文档</span>
            </a>
    </div>

    </div>

    </nav>

            </div>
        </aside>

        <article role="main" class="page-content g-9">
<a href="https://github.com/hltj/kotlin-web-site-cn/edit/master/pages/docs/tutorials/native/mpp-ios-android.md"
   class="page-link-to-github"
   target="_blank"
   title="在 GitHub 上编辑本页">
        <i class="github-icon"></i>
        <span class="text">编辑本页</span>
</a>
            <h1>
                多平台项目: iOS 与 Android
            </h1>
            <table>
                    <tr>
                        <td>
                            <strong>作者</strong>
                        </td>
                        <td>
                            Eugene Petrenko，乔禹昂（翻译）
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <strong>最近更新</strong>
                        </td>
                        <td>
                            2019-08-11
                        </td>
                    </tr>
            </table>
                在 iOS 与 Android 之间共享 Kotlin 代码
                <br/>
                <br/>
            
<p>在本教程中，我们会创建一个 iOS 与 Android 两用的应用，来展示 Kotlin 代码的共享能力。
对于 Android，我们会使用 Kotlin/JVM，而对于 iOS 会使用 Kotlin/Native。</p>
<p>我们将学习到如何：</p>
<ul>
<li>使用 Android Studio 创建一个 <a href="#创建一个-Android-项目">Android app</a></li>
<li>创建一个共享的 <a href="#创建共享模块">Kotlin library</a>
<ul>
<li>在 <a href="#在-android-中使用共享代码">Android app</a> 中使用 Kotlin 库</li>
<li>运行 <a href="#运行-android-应用程序">Android 应用程序</a></li>
</ul>
</li>
<li>使用 Xcode 创建一个 <a href="#创建-ios-应用程序">iOS app</a>
<ul>
<li>在 <a href="#在-xcode-中配置-framework-依赖">iOS app</a> 上使用共享的 Kotlin 库</li>
<li>在 <a href="#在-swift-中调用-kotlin-代码">Swift 中调用 Kotlin</a></li>
<li>运行 <a href="#运行-ios-应用程序">iOS 应用程序</a></li>
</ul>
</li>
</ul>
<p>我们即将创建的应用程序会在 Android 设备上显示
<code>Kotlin Rocks on Android</code> 而在 iOS 设备上显示 <code>Kotlin Rocks on iOS &lt;version&gt;</code>。
Our goal is to demonstrate the ability to share Kotlin code between the platforms, the project setup, and the benefits that
this provides. While we'll be demonstrating this with a simple application, what is shown here can be applied to real-world applications, no matter their size or complexity.</p>
<p>通用的代码是 <code>"Kotlin Rocks on ${platformName()}"</code>，<code>platformName()</code>
是一个使用 <code>expect</code> 关键字声明的函数。而 <code>actual</code> 的实现将根据特定的平台而异。</p>
<h1 id="搭建本地环境">搭建本地环境</h1>
<ul>
<li>
<p>我们将使用 <a href="https://developer.android.com/studio/">Android Studio</a> 来讲解 Android 部分的内容.
当然也可以使用 <a href="https://jetbrains.com/idea">IntelliJ IDEA</a> 社区版或终级版。</p>
</li>
<li>
<p>IDE 应该安装了 Kotlin 插件 1.3.41 或更高版本。这个可以通过
<em>Settings</em>（或 <em>Preferences</em>）窗口中的 <em>Language &amp; Frameworks | Kotlin Updates</em> 部分验证。</p>
</li>
<li>
<p>编译 iOS 以及 macOS 设备的代码需要 masOS 系统。我们需要安装以及配置
<a href="https://developer.apple.com/xcode/">Xcode</a> 工具。查看
<a href="https://developer.apple.com/xcode/">Apple 开发者网站</a>来获取更多细节。</p>
</li>
</ul>
<p><em>注意：我们会使用 IntelliJ IDEA 2019.2、Android Studio 3.4、
Kotlin 1.3.41、Xcode 10.3、macOS 10.14、Gradle 5.5.1</em></p>
<h1 id="创建一个-android-项目">创建一个 Android 项目</h1>
<p>We need Android Studio for the tutorial. We can download and install it from the
<a href="https://developer.android.com/studio/">https://developer.android.com/studio/</a>. Let's open
the IDE and check that we see the newest Kotlin version, namely 
1.3.41
or newer under the Kotlin section <em>Languages &amp; Frameworks</em> | <em>Kotlin</em>
in the <em>Settings</em> (or <em>Preferences</em>) dialog of Android Studio.</p>
<p>Our first step is to create a new Android project via the <em>Start a new Android project</em> item on the Android Studio home screen. 
We then proceed to select the <em>Empty Activity</em> option and click <em>Next</em>. It's important to pick the <em>Kotlin</em>
language in the wizard. Let's use the <code>com.jetbrains.handson.mpp.mobile</code> package
for the tutorial. Now we can press the <em>Finish</em> button and create our new Android project.</p>
<p>At this point, we should be able to compile and run the Android application. Let's check that it works!</p>
<h1 id="创建共享模块">创建共享模块</h1>
<p>本教程的目标是演示在 Android 与 iOS 之间 Kotlin 代码的复用性。我们了来以在
Gradle 项目中手动创建一个 <code>SharedCode</code> 子项目开始。<code>SharedCode</code> 项目的源代码<!--
-->会在两个平台之间共享。
我们会在项目中创建几个新文件来实现这个目标。</p>
<h2 id="updating-gradle-scripts">Updating Gradle Scripts</h2>
<p>The <code>SharedCode</code> sub-project should generate several artifacts for us:</p>
<ul>
<li>A JAR file for the Android project, from the <code>androidMain</code> source set</li>
<li>The Apple framework
    <ul>
<li>for iOS device and App Store (<code>arm64</code> target)</li>
<li>for iOS simulator (<code>x86_64</code> target)</li>
</ul>
</li>
</ul>
<p>Let's update the Gradle scripts now to implement this and configure our IDE.
First, we add the new project to the <code>settings.gradle</code> file, simply by adding the following line to the end of the file:</p>
<div auto-indent="false" class="sample" data-highlight-only="1" mode="groovy" theme="idea">
<pre><code class="language-groovy">include ':SharedCode'
</code></pre>
</div>
<p>Next,
we need to create a <code>SharedCode/build.gradle.kts</code> file with the following content:</p>
<div auto-indent="false" class="sample" data-highlight-only="1" mode="groovy" theme="idea">
<pre><code class="language-kotlin">import org.jetbrains.kotlin.gradle.plugin.mpp.KotlinNativeTarget

plugins {
    kotlin("multiplatform")
}

kotlin {
    //select iOS target platform depending on the Xcode environment variables
    val iOSTarget: (String, KotlinNativeTarget.() -&gt; Unit) -&gt; KotlinNativeTarget =
        if (System.getenv("SDK_NAME")?.startsWith("iphoneos") == true)
            ::iosArm64
        else
            ::iosX64

    iOSTarget("ios") {
        binaries {
            framework {
                baseName = "SharedCode"
            }
        }
    }

    jvm("android")

    sourceSets["commonMain"].dependencies {
        implementation("org.jetbrains.kotlin:kotlin-stdlib-common")
    }

    sourceSets["androidMain"].dependencies {
        implementation("org.jetbrains.kotlin:kotlin-stdlib")
    }
}

val packForXcode by tasks.creating(Sync::class) {
    val targetDir = File(buildDir, "xcode-frameworks")

    /// selecting the right configuration for the iOS 
    /// framework depending on the environment
    /// variables set by Xcode build
    val mode = System.getenv("CONFIGURATION") ?: "DEBUG"
    val framework = kotlin.targets
                          .getByName&lt;KotlinNativeTarget&gt;("ios")
                          .binaries.getFramework(mode)
    inputs.property("mode", mode)
    dependsOn(framework.linkTask)

    from({ framework.outputDirectory })
    into(targetDir)

    /// generate a helpful ./gradlew wrapper with embedded Java path
    doLast {
        val gradlew = File(targetDir, "gradlew")
        gradlew.writeText("#!/bin/bash\n" 
            + "export 'JAVA_HOME=${System.getProperty("java.home")}'\n" 
            + "cd '${rootProject.rootDir}'\n" 
            + "./gradlew \$@\n")
        gradlew.setExecutable(true)
    }
}

tasks.getByName("build").dependsOn(packForXcode)
</code></pre>
</div>
<p>We need to refresh the Gradle project to apply these changes. Click on the <code>Sync Now</code> link or 
use the <em>Gradle</em> tool window and click the refresh action from the context menu on the root Gradle project.
The <code>packForXcode</code> Gradle task is used for Xcode project integration. We will discuss this later in the
tutorial.</p>
<h2 id="添加-kotlin-源码">添加 Kotlin 源码</h2>
<p>我们想要使每个平台都根据平台自身展示相似的文本：<code>Kotlin Rocks on Android</code> 以及
<code>Kotlin Rocks on iOS</code>。我们将复用生成消息的方式。
让我们在项目根目录下用以下内容创建文件（以及缺少的目录）：
<code>SharedCode/src/commonMain/kotlin/common.kt</code>。</p>
<div auto-indent="false" class="sample" data-highlight-only="1" mode="kotlin" theme="idea">
<pre><code class="language-kotlin">package com.jetbrains.handson.mpp.mobile

expect fun platformName(): String

fun createApplicationScreenMessage() : String {
  return "Kotlin Rocks on ${platformName()}"
}

</code></pre>
</div>
<p>这是通用的部分。这段代码生成了最终的消息。它期待（<code>expect</code>）平台部分<!--
-->提供来自 <code>expect fun platformName（）：String</code> 函数的平台相关名称。我们会同时在
Android 与 iOS 应用中使用 <code>createApplicationScreenMessage</code>。</p>
<p>现在我们需要在 <code>SharedCode/src/androidMain/kotlin/actual.kt</code> 中为 Android 创建相应的实现文件（与缺失的目录）：</p>
<div auto-indent="false" class="sample" data-highlight-only="1" mode="kotlin" theme="idea">
<pre><code class="language-kotlin">package com.jetbrains.handson.mpp.mobile

actual fun platformName(): String {
  return "Android"
}

</code></pre>
</div>
<p>我们为 iOS 也创建了一个相似的实现文件（与缺失的目录） <code>SharedCode/src/iosMain/kotlin/actual.kt</code>：</p>
<div auto-indent="false" class="sample" data-highlight-only="1" mode="kotlin" theme="idea">
<pre><code class="language-kotlin">package com.jetbrains.handson.mpp.mobile

import platform.UIKit.UIDevice

actual fun platformName(): String {
  return UIDevice.currentDevice.systemName() +
         " " +
         UIDevice.currentDevice.systemVersion
}
</code></pre>
</div>
<p>这里我们可以使用 Apple UIKit Framework 中的 <a href="https://developer.apple.com/documentation/uikit/uidevice?language=objc">UIDevice</a>
类，这是一个仅仅在 Swift 以及 Objective-C 中使用而在 Java 中没有的类。
Kotlin/Native 编译器带有一组预先导入的 framework，所以我们可以<!--
-->使用 UIKit Framework 而无需任何额外步骤。
Objective-C 与 Swift 互操作在这篇<a href="/docs/reference/native/objc_interop.html">文档</a>中有详细介绍</p>
<h2 id="多平台-gradle-项目">多平台 Gradle 项目</h2>
<p><code>SharedCode/build.gradle.kts</code> 文件使用了 <code>kotlin-multiplatform</code> 插件来实现<!--
-->我们所需的功能。
在这个文件中，我们定义了一些平台目标：<code>common</code>、<code>android</code> 以及 <code>iOS</code>。 每一个<!--
-->都对应它自己的平台。<code>common</code> 目标平台包含了公共 Kotlin 代码，
它会被导入每一个平台的编译中。它允许拥有 <code>expect</code> 声明。
其它的目标为 <code>common</code> 目标中的所有 <code>expect</code> 函数提供了 <code>actual</code> 实现。
关于更多多平台项目的细节说明可以在<!--
--><a href="/docs/reference/building-mpp-with-gradle.html">多平台项目</a>文档页中找到。</p>
<p>让我们用下面的表格总结一下：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>源路径</th>
<th>目标</th>
<th>构件</th>
</tr>
</thead>
<tbody>
<tr>
<td>common</td>
<td><code>SharedCode/commonMain/kotlin</code></td>
<td>-</td>
<td>Kotlin metadata</td>
</tr>
<tr>
<td>android</td>
<td><code>SharedCode/androidMain/kotlin</code></td>
<td>JVM 1.6</td>
<td><code>.jar</code> file 或 <code>.class</code> files</td>
</tr>
<tr>
<td>iOS</td>
<td><code>SharedCode/iosMain</code></td>
<td>iOS arm64 or x86_64</td>
<td>Apple framework</td>
</tr>
</tbody>
</table>
<p>现在是时候再次在 Android Studio 中刷新这个 Gradle 项目了。在黄色条目上点击 <em>Sync Now</em>
或者在根 Gradle 项目的上下文菜单中使用 <em>Gradle</em> 工具窗口并点击 <code>Refresh</code> 按钮。
现在 <code>:SharedCode</code> 项目应该被 IDE 识别了。</p>
<p>We can use the <code>step-004</code> branch from the 
<a href="https://github.com/kotlin-hands-on/mpp-ios-android/tree/step-004">github.com/kotlin-hands-on/mpp-ios-android</a>
repository as a solution for the tasks that we've done above. We can also download the
<a href="https://github.com/kotlin-hands-on/mpp-ios-android/archive/step-004.zip">archive</a> from GitHub directly
or check out the repository and select the branch.</p>
<p>Let's use the <code>SharedCode</code> library from our Android and iOS applications.</p>
<h1 id="在-android-中使用共享代码">在 Android 中使用共享代码</h1>
<p>在这部分教程中，我想将 Android 项目的改动降到最低，所以我们在主项目中添加了对
<code>SharedCode</code> 项目的普通依赖。
也可以直接在 Android Gradle 项目中使用 <code>kotlin-multiplatform</code>
插件，来代替 <code>kotlin-android</code> 插件。关于更多信息，请参考<!--
--><a href="/docs/reference/multiplatform.html">多平台项目</a>文档。</p>
<p>让我们将对 <code>SharedCode</code> 项目的依赖引入 Android 项目。我们需要修改
<code>app/build.gradle</code> 文件并在 <code>dependencies { .. }</code> 块中加入以下这行代码：</p>
<div auto-indent="false" class="sample" data-highlight-only="1" mode="groovy" theme="idea">
<pre><code class="language-groovy">    implementation project(':SharedCode')
</code></pre>
</div>
<p>我们需要<!--
-->给 <code>TextView</code> 指定 <code>id</code> 以用来在我们控制它的 activity 的代码中访问它。
让我们修改
<code>app/src/main/res/layout/activity_main.xml</code> 文件<!--
-->（如果我们在新项目向导中更改了名称，则名称可能会有所不同）。
Select the <em>Text</em> tab at the bottom of the preview to switch it to XML
并且为 <code>&lt;TextView&gt;</code> 元素添加几个更多的属性：</p>
<pre><code>        android:id="@+id/main_text"
        android:textSize="42sp"
        android:layout_margin="5sp"
        android:textAlignment="center"
</code></pre>
<p>Next, let's add the following line of code to the end of the <code>onCreate</code> method from the <code>MainActivity</code> class
in the <code>/app/src/main/java/com/jetbrains/handson/mpp/mobile/MainActivity.kt</code> file, :</p>
<pre><code>findViewById&lt;TextView&gt;(R.id.main_text).text = createApplicationScreenMessage()
</code></pre>
<p>You will need to add the import for the <code>android.widget.TextView</code> class. Android Studio
will automatically suggest adding the import. Depending on the Android application package,
we may also need to add the import for the <code>createApplicationScreenMessage()</code> function too.
We should see these two lines at the beginning of the <code>MainActivity.kt</code> file:</p>
<pre><code class="code _highlighted" data-lang="text/x-kotlin">import com.jetbrains.handson.mpp.mobile.createApplicationScreenMessage
import android.widget.TextView
</code></pre>
<p>现在我们拥有一个 <code>TextView</code>，它将使用可共享的函数 <code>createApplicationScreenMessage()</code>
为我们展示文本。它将显示 <code>Kotlin Rocks on Android</code>。
我们通过运行该 Android 程序来看下它是如何工作的。</p>
<p>We can use the <code>step-005</code> branch of the 
<a href="https://github.com/kotlin-hands-on/mpp-ios-android/tree/step-005">github.com/kotlin-hands-on/mpp-ios-android</a>
repository as a solution for the tasks we've done above. We can also download the
<a href="https://github.com/kotlin-hands-on/mpp-ios-android/archive/step-005.zip">archive</a> from GitHub directly
or check out the repository and select the branch.</p>
<h2 id="运行-android-应用程序">运行 Android 应用程序</h2>
<p>让我们点击 <code>App</code> 运行配置<!--
-->来让我们的项目在真正的 Android 设备或模拟器上运行。</p>
<p><img alt="Start the Application" src="/assets/images/tutorials/native/mpp-ios-android/studio-start-app.png"/></p>
<p>现在我们可以看到应用程序运行在 Android 模拟器上。</p>
<p><img alt="Emulator App" src="/assets/images/tutorials/native/mpp-ios-android/android-emulator-kotlin-rocks-android.png" width="30%"/></p>
<h1 id="创建-ios-应用程序">创建 iOS 应用程序</h1>
<p>We can start by opening Xcode and selecting the <em>Create a new Xcode project</em> option. In 
the dialog, we need to choose the iOS target and select the <em>Single View App</em> and click next. Fill in the next page with the defaults, 
and use <code>KotlinIOS</code> as the <em>Product Name</em>. Let's select <em>Swift</em> as the language (it is possible to use
Objective-C too). Use the <code>com.jetbrains.handson.mpp.mobile</code> string for the <em>Organization Identifier</em> field.
Now the <em>Next</em> button should be available, let's click it to move on.
In the file dialog, shown after clicking the <em>Next</em> button, we need to select the root folder
of our project, click the <em>New Folder</em> button and create a folder called <code>native</code> in it. 
The folder should be selected now, and we can click the <em>Create</em>
button to complete the dialog. We will use relative paths in the configuration files later in this tutorial.</p>
<p>The created iOS application is ready to run on the iOS simulator or iOS device. For the device to run
it may require an Apple developer account and a developer certificate. Xcode does its
best to get us through the process.</p>
<p>Let's make sure we can run the application on the iPhone simulator or device by clicking the play button
from the XCode window title bar.</p>
<p>The <code>step-006</code> branch of the 
<a href="https://github.com/kotlin-hands-on/mpp-ios-android/tree/step-006">github.com/kotlin-hands-on/mpp-ios-android</a>
repository contains a possible solution for the tasks that we have done above.  We can also download the
<a href="https://github.com/kotlin-hands-on/mpp-ios-android/archive/step-006.zip">archive</a> from GitHub directly or
check out the repository and select the branch.</p>
<h1 id="在-xcode-中配置-framework-依赖">在 Xcode 中配置 Framework 依赖</h1>
<p>Let's run the <code>packForXcode</code> Gradle task of the <code>SharedCode</code> project. We can do it either from
the <em>Gradle</em> tab in AndroidStudio or by running the <code>./gradlew :SharedCode:packForXcode</code> command
from console. This task is designed to help to simplify the setup of our iOS Framework
in the Xcode project model.</p>
<p>We need several binaries from the framework to use it with Xcode:</p>
<ul>
<li><code>iOS arm64 debug</code> — the binary to run the iOS device in debug mode</li>
<li><code>iOS arm64 release</code> — the binary to include into a release version of an app</li>
<li><code>iOS x64 debug</code> — the binary for iOS simulator, which uses the desktop mac CPU</li>
</ul>
<p>The easiest way to configure Xcode to use a custom-built framework is to
place the framework under the same folder for all configurations and targets.
Then add a custom step to the Xcode project build to update or build the
framework before the actual Xcode build is started. Xcode sets several environment
variables for custom steps; we can use these variables in the Gradle script to select
the requested target platform and the configuration. For more details,
please refer to the <code>packForXcode</code> task sources in the <code>SharedCode/build.gradle.kts</code> file.</p>
<p>Let's now switch back to Android Studio and execute the <code>build</code> target of the <code>SharedCode</code> project from
the <em>Gradle</em> tool window. The task looks for environment variables set by the Xcode build and copies
the right variant of the framework to the <code>SharedCode/build/xcode-frameworks</code> folder. We can then include the
framework from that folder into the build</p>
<h2 id="配置-xcode">配置 Xcode</h2>
<p>We need to add the <code>SharedCode</code> framework to the Xcode project.
To do this we can double-click on the <code>KotlinIOS</code> node (or root node) of the <em>project navigator (⌘1)</em> tree
to open the <em>target</em> settings.
Next we then click on the <code>+</code> in the <em>Embedded Binaries</em> section, click <em>Add Other…</em> button in the dialog
to choose the framework from the disk. We can then point to the following folder:</p>
<pre><code>SharedCode/build/xcode-frameworks/SharedCode.framework
</code></pre>
<p>In the next dialog, we need to select the <em>Create folder references</em> option and make sure that the <em>Copy items if needed</em>
checkbox isn't checked. We should then see something like this: 
<img alt="Xcode General Screen" src="/assets/images/tutorials/native/mpp-ios-android/xcode-general.png"/></p>
<p>Now we need to explain to Xcode, where to look for the framework.
For this, we open the <em>Build Settings</em> tab again, pick the <em>All</em> sub-tab below, and type the <em>Framework Search Paths</em> into
the search field to find the option easily. We need to add the <em>relative</em> path 
<code>$(SRCROOT)/../../SharedCode/build/xcode-frameworks</code> to the <em>Search Paths | Framework Search Paths</em> section.
Xcode will then show the substituted path in the UI for it.</p>
<p><img alt="Xcode Build Settings" src="/assets/images/tutorials/native/mpp-ios-android/xcode-search-path.png"/></p>
<p>最后一步是让 Xcode 调用我们的 Gradle build 任务在每次运行前准备 <code>SharedCode</code> framework。
We can open the <em>Build Phases</em> tab and click <code>+</code> to add the <em>New Run Script Phase</em>, drag that step to the very
first position, and add the following code to the shell script text:</p>
<div auto-indent="false" class="sample" data-highlight-only="1" mode="bash" theme="idea">
<pre><code class="language-bash">cd "$SRCROOT/../../SharedCode/build/xcode-frameworks"
./gradlew :SharedCode:packForXCode -PXCODE_CONFIGURATION=${CONFIGURATION}
</code></pre>
</div>
<p>注意，这里我们使用 <code>$SRCROOT/../..</code> 作为我们的 Gradle 项目的根路径。
它取决于 Xcode 项目的创建方式。另外，我们使用生成的
<code>SharedCode/build/xcode-frameworks/gradlew</code> 脚本，
<code>packForXCode</code> 任务会生成它。在新机器上打开 Xcode 项目<em>之前</em>，
我们假设 Gradle 的 build 任务至少执行一次。</p>
<p>The <code>step-007</code> branch of the 
<a href="https://github.com/kotlin-hands-on/mpp-ios-android/tree/step-007">github.com/kotlin-hands-on/mpp-ios-android</a>
repository contains a possible solution for the tasks that we have done above. We can also download the
<a href="https://github.com/kotlin-hands-on/mpp-ios-android/archive/step-007.zip">archive</a> from GitHub directly or
check out the repository and select the branch.</p>
<p><img alt="Xcode Build Phases" src="/assets/images/tutorials/native/mpp-ios-android/xcode-run-script.png"/></p>
<p>我们应该将创建好的 build phase 拖到列表的顶部</p>
<p><img alt="Xcode Build Phases" src="/assets/images/tutorials/native/mpp-ios-android/xcode-run-script-order.png"/></p>
<p>We are now ready to start coding the iOS application with Kotlin</p>
<h2 id="在-swift-中调用-kotlin-代码">在 Swift 中调用 Kotlin 代码</h2>
<p>请牢记，我们的目标是在屏幕上展示这条信息。我们可以看到，我们的 iOS 应用没有在屏幕上<!--
-->绘制任何内容。让我们使用 <code>UILabel</code> 展示这条消息。
Let's open the <code>ViewController.swift</code> file from the <em>project navigator (⌘1)</em> tree.
我们需要使用下面的代码替换 <code>ViewController.swift</code> 文件中的内容：</p>
<div auto-indent="false" class="sample" data-highlight-only="1" mode="swift" theme="idea">
<pre><code class="language-swift">import UIKit
import SharedCode

class ViewController: UIViewController {
    override func viewDidLoad() {
        super.viewDidLoad()
        
        let label = UILabel(frame: CGRect(x: 0, y: 0, width: 300, height: 21))
        label.center = CGPoint(x: 160, y: 285)
        label.textAlignment = .center
        label.font = label.font.withSize(25)
        label.text = CommonKt.createApplicationScreenMessage()
        view.addSubview(label)
    }
}
</code></pre>
</div>
<p>我们使用 <code>import SharedCode</code> 来导入我们使用 Kotlin/Native 编译的 Kotlin 代码而生成的 Framework。
接下来，我们调用库中的 Kotlin 函数作为<code>CommonKt.createApplicationScreenMessage()</code>。然后
<a href="/docs/tutorials/native/apple-framework.html">Kotlin/Native 开发 Apple Framework</a> 教程中<!--
-->有更多关于 Kotlin/Native 与 Swift（或 Objective-C）互操作的细节。</p>
<p>The <code>step-008</code> branch of the 
<a href="https://github.com/kotlin-hands-on/mpp-ios-android/tree/step-008">github.com/kotlin-hands-on/mpp-ios-android</a>
repository contains a possible solution for the tasks that we have done above. We can also download the
<a href="https://github.com/kotlin-hands-on/mpp-ios-android/archive/step-008.zip">archive</a> from GitHub directly or
check out the repository and select the branch.</p>
<p>现在，我们已准备好在模拟器或 iOS 设备上启动应用程序。</p>
<h2 id="运行-ios-应用程序">运行 iOS 应用程序</h2>
<p>让我们在 Xcode 中点击 <em>Run</em> 按钮，接下来我们将看到应用程序运行</p>
<p><img alt="Emulator App" src="/assets/images/tutorials/native/mpp-ios-android/iPhone-emulator-kotlin-rocks.png" width="30%"/></p>
<h1 id="总结">总结</h1>
<p>在本篇教程中我们：</p>
<ul>
<li>在 Android Studio 中创建了一个 Android 应用程序</li>
<li>在 Xcode 中创建了一个 iOS 应用程序</li>
<li>添加了 Kotlin 多平台项目子项目
    <ul>
<li>共享 Kotlin 代码</li>
<li>将它编译成 Android Jar</li>
<li>将它编译成 iOS Framework</li>
</ul>
</li>
<li>将它们放在一起并复用 Kotlin 代码</li>
</ul>
<p>我们可以在 <a href="https://github.com/JetBrains/kotlin-examples/tree/master/tutorials/mpp-iOS-Android">GitHub</a> 上找到这篇教程的所有源码。</p>
<h1 id="接下来">接下来</h1>
<p>This small example of Kotlin code sharing between iOS and Android (and other platforms) 
with Kotlin, Kotlin/Native, and Kotlin multiplatform projects is only the beginning. 
The same approach can work for real applications, independent of their size or complexity.</p>
<p>Kotlin/Native 与 Swift 以及 Objective-C 的互操作被包含在这篇<!--
--><a href="/docs/reference/native/objc_interop.html">文档</a>中。
<a href="apple-framework.html">Kotlin/Native 开发 Apple Framework</a> 教程也涵盖这个主题<!--
-->。</p>
<p>多平台项目以及多平台库在这篇<a href="/docs/reference/multiplatform.html">文档</a>中讨论。</p>
<p>在平台之间共享代码是一种强大的技术，但是它可能很难在
Android、JVM 或 iOS 这些拥有丰富不同 API 的平台上办到。
而多平台库可以被用来解决这一问题。它们直接使用<!--
-->通用的 Kotlin 代码来提供丰富的 API。举例来说我们有如下的多平台库：</p>
<ul>
<li><a href="https://github.com/Kotlin/kotlinx.coroutines/blob/master/native/README.md">kotlinx.coroutines</a></li>
<li><a href="https://github.com/Kotlin/kotlinx-io">kotlinx.io</a></li>
<li><a href="https://github.com/Kotlin/kotlinx.serialization">kotlinx.serialization</a></li>
<li><a href="https://ktor.io/">ktor</a></li>
<li><a href="https://ktor.io/clients/http-client.html">ktor-http-client</a></li>
</ul>
<p>想了解更多 API？来轻松的创建一个<a href="/docs/tutorials/multiplatform-library.html">多平台项目</a>并共享它吧！</p>

        </article>
    </div>
    </div>

</div>

<footer role="contentinfo" class="global-footer">

    <div class="global-footer-terms">
        <div class="g-layout">

            <div class="global-footer-container">
                <div class="global-footer-row">
                    <div class="terms-copyright">
                        采用 <a href="https://github.com/JetBrains/kotlin-web-site/blob/master/LICENSE">Apache
                        2
                        授权许可</a>
                    </div>

                    <div class="terms-foundation">
                        Kotlin 商标受 <a
                            href="/foundation/kotlin-foundation.html">Kotlin 基金会</a>保护
                    </div>
                    <a class="terms-kit"
                            href=/assets/kotlin-media-kit.pdf>宣传资料</a>
                </div>
                <div class="global-footer-row">
                    <div class="terms-sponsor">
                        由 <a href="http://jetbrains.com" class="sponsor sponsor_jetbrains"
                                                      target="_blank">JetBrains</a> 赞助及开发；
                        由<a href="https://hltj.me/" class="testimonial-company-link" target="_blank" rel="nofollow">灰蓝天际</a>、<a href="http://tanfujun.com" class="testimonial-company-link" target="_blank" rel="nofollow">晓_晨DEV</a> &nbsp;<a href="/contribute.html#中文站翻译贡献者" class="testimonial-company-link" target="_blank" rel="nofollow">等</a>译
                    </div>
                </div>

            </div>
        </div>
    </div>

</footer>
    <script src="/_assets/tutorial.js"></script>
    <link rel="stylesheet" href="/_assets/tutorial.css">
<div class="search-popup _hidden" tabindex="1000">
    <div class="search-popup__content">
        <div class="search-popup__controls">
            <div class="search-popup__input"></div>
            <div class="search-popup__close">
                <div class="search-popup__close-icon-wrapper">
                    <div class="search-popup__close-icon"></div>
                </div>
                <div class="search-popup__close-text">esc</div>
            </div>
        </div>
        <div class="search-popup__results"></div>
    </div>
</div></body>
</html>